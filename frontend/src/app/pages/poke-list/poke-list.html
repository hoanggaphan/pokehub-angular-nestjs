<div class="container mx-auto p-4 space-y-4">
  <div class="flex flex-wrap items-end gap-3">
    <div>
      <label class="block text-xs mb-1">Search</label>
      <input class="border rounded px-3 py-2 w-64" type="text" [ngModel]="q()" (ngModelChange)="q.set($event); store.searchByName($event)" placeholder="Search by name..." />
    </div>
    <div>
      <label class="block text-xs mb-1">Type</label>
      <input class="border rounded px-3 py-2 w-40" type="text" [ngModel]="type()" (ngModelChange)="type.set($event || undefined); store.updateFilter({ type: $event || undefined, page: 1 }); store.load()" placeholder="e.g. Fire" />
    </div>
    <div>
      <label class="block text-xs mb-1">Legendary</label>
      <select class="border rounded px-3 py-2" [ngModel]="legendary()" (ngModelChange)="legendary.set($event); store.updateFilter({ legendary: $event === '' ? null : $event === 'true', page: 1 }); store.load()">
        <option value="">Any</option>
        <option value="true">Yes</option>
        <option value="false">No</option>
      </select>
    </div>
    <div>
      <label class="block text-xs mb-1">Speed min</label>
      <input class="border rounded px-3 py-2 w-24" type="number" [ngModel]="speedMin()" (ngModelChange)="speedMin.set($event); store.updateFilter({ speedMin: $event === null || $event === '' ? null : (+$event), page: 1 }); store.load()" />
    </div>
    <div>
      <label class="block text-xs mb-1">Speed max</label>
      <input class="border rounded px-3 py-2 w-24" type="number" [ngModel]="speedMax()" (ngModelChange)="speedMax.set($event); store.updateFilter({ speedMax: $event === null || $event === '' ? null : (+$event), page: 1 }); store.load()" />
    </div>
    <div class="ml-auto">
      <a class="inline-flex items-center gap-2 border rounded px-3 py-2 hover:bg-gray-50" routerLink="/upload">
        <span class="material-icons !text-rose-500">file_upload</span>
        Import CSV
      </a>
    </div>
  </div>

  <div class="flex items-center justify-between">
    <div class="text-sm opacity-80">Total: {{ store.total() }} Â· Page {{ store.page() }} / {{ store.pageCount() }}</div>
    <div class="flex items-center gap-2">
      <span class="text-sm">Per page</span>
      <select class="border rounded px-2 py-1" [ngModel]="store.limit()" (ngModelChange)="store.setLimit($event); store.load()">
        @for (n of limits; track n) { <option [ngValue]="n">{{ n }}</option> }
      </select>
    </div>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
    @for (p of store.sortedPokemon(); track p.id) {
      <app-pokemon-card [pokemon]="p" />
    }
  </div>

  <div class="flex items-center justify-center gap-2">
    <button class="border rounded px-3 py-1" [disabled]="store.page() <= 1" (click)="store.setPage(store.page() - 1); store.load()">Prev</button>
    <button class="border rounded px-3 py-1" [disabled]="store.page() >= store.pageCount()" (click)="store.setPage(store.page() + 1); store.load()">Next</button>
  </div>
</div>

